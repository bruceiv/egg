#!/bin/zsh

nxml=( output/unaive-*-xml.csv(om[1]) )
njson=( output/unaive-*-json.csv(om[1]) )
njava=( output/unaive-*-java.csv(om[1]) )
pxml=( output/upackrat-*-xml.csv(om[1]) )
pjson=( output/upackrat-*-json.csv(om[1]) )
pjava=( output/upackrat-*-java.csv(om[1]) )
dxml=( output/uderiv-*-xml.csv(om[1]) )
djson=( output/uderiv-*-json.csv(om[1]) )
djava=( output/uderiv-*-java.csv(om[1]) )

join -t ',' $nxml $pxml > pxml-join.csv
join -t ',' $njson $pjson > pjson-join.csv
join -t ',' $njava $pjava > pjava-join.csv
join -t ',' $nxml $dxml > dxml-join.csv
join -t ',' $njson $djson > djson-join.csv
join -t ',' $njava $djava > djava-join.csv
join -t ',' $pxml $dxml > d2xml-join.csv
join -t ',' $pjson $djson > d2json-join.csv
join -t ',' $pjava $djava > d2java-join.csv

if [[ ! -d plots ]]; then mkdir plots; fi

gnuplot -e "nxml='${nxml}'; njson='${njson}'; njava='${njava}'; pxml='${pxml}'; pjson='${pjson}'; pjava='${pjava}'; dxml='${dxml}'; djson='${djson}'; djava='${djava}'" plots.plg

rm {p,d,d2}{xml,json,java}-join.csv
